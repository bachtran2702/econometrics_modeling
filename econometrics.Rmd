---
title: "econometrics"
author: "Bach Tran"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(stats)
library(tidyr)
library(tseries) 
library(TTR)
library(zoo)
library(forecast)
library(lubridate)
library(car) 
library(ggplot2)
library(quantmod)
library(tsibble)
library(xts)
library(tibble)
library(fpp2)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r macro data, echo = T}
#wrestle the data from chr type "%m/%d/%y" data to zoo type year month 
dta = read.csv("base_model_dta.csv", col.names = c("month", "unemployment_r", "fed_fund_r", "consumer_sent")) %>%
  mutate(month = as.character(
    as.Date(month, format = "%m/%d/%y"))
  ) %>%
  mutate(month = yearmonth(month))
```

```{r sp500 performance data, echo =T}
#subset period
start = "2018-09-01"
end = "2024-10-31"

# Assign SPY data to 'spy' 
spy = getSymbols("SPY", auto.assign = F, from = start, to = end)

#Extract adjusted close
spy_adj = Ad(spy) 
monthly_spy_adj = apply.monthly(spy_adj, FUN = mean)

#convert xts to data frame
spy_df = as.data.frame(monthly_spy_adj) %>%
  rownames_to_column(var = "month")
#wrestle the data to year month
spy_df = spy_df%>%
  mutate(month = yearmonth(month))
```


```{r tsible, echo=FALSE}
combined = merge(dta, spy_df)

analysis_rdy_tsibble = combined%>%
  as_tsibble(index = month)

```


```{r descriptive stats, echo=FALSE}
data_no_date = combined%>%
  select(-month)

summary(data_no_date)
```

```{r trend visualization, echo=FALSE}
#as time series

ggplot(combined, aes(x = month)) +
    geom_line(aes(y = unemployment_r), color = "#ED3833") +
    geom_line(aes(y = fed_fund_r), color ="#073D7F") +
    labs(y = "Price ", x = "Year" )
                          
#higher unemployment earlier of the year, lower at the end of the year; unemployment in 2024 is on par with non-pandemic year 
gg_season(analysis_rdy_tsibble, unemployment_r)
gg_subseries(analysis_rdy_tsibble, unemployment_r)


#no clear trend in stock performance  M-o-M. Market is at an all tiome high and continue growing 
#I changed the color scale because this is just slightly easier to see compare to the default.
gg_season(analysis_rdy_tsibble, SPY.Adjusted, pal = (scales::viridis_pal())(9))
gg_subseries(analysis_rdy_tsibble,  SPY.Adjusted)
## Including Plots

##Foundation done. Now look for a company then forcast the industry performance.
        
```





## Including Plots


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
